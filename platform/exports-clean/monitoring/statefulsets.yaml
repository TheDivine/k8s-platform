apiVersion: v1
items:
  - apiVersion: apps/v1
    kind: StatefulSet
    metadata:
      annotations:
        meta.helm.sh/release-name: monitoring
        meta.helm.sh/release-namespace: monitoring
        prometheus-operator-input-hash: "7333261605762747118"
      labels:
        alertmanager: monitoring-kube-prometheus-alertmanager
        app: kube-prometheus-stack-alertmanager
        app.kubernetes.io/instance: monitoring-kube-prometheus-alertmanager
        app.kubernetes.io/managed-by: prometheus-operator
        app.kubernetes.io/name: alertmanager
        app.kubernetes.io/part-of: kube-prometheus-stack
        app.kubernetes.io/version: 79.6.1
        chart: kube-prometheus-stack-79.6.1
        heritage: Helm
        managed-by: prometheus-operator
        release: monitoring
      name: alertmanager-monitoring-kube-prometheus-alertmanager
      namespace: monitoring
      ownerReferences:
        - apiVersion: monitoring.coreos.com/v1
          blockOwnerDeletion: true
          controller: true
          kind: Alertmanager
          name: monitoring-kube-prometheus-alertmanager
          uid: 56e0a879-e38a-4b61-88ef-52a0181a7209
    spec:
      persistentVolumeClaimRetentionPolicy:
        whenDeleted: Retain
        whenScaled: Retain
      podManagementPolicy: Parallel
      replicas: 1
      revisionHistoryLimit: 10
      selector:
        matchLabels:
          alertmanager: monitoring-kube-prometheus-alertmanager
          app.kubernetes.io/instance: monitoring-kube-prometheus-alertmanager
          app.kubernetes.io/managed-by: prometheus-operator
          app.kubernetes.io/name: alertmanager
      serviceName: alertmanager-operated
      template:
        metadata:
          annotations:
            kubectl.kubernetes.io/default-container: alertmanager
          creationTimestamp: null
          labels:
            alertmanager: monitoring-kube-prometheus-alertmanager
            app.kubernetes.io/instance: monitoring-kube-prometheus-alertmanager
            app.kubernetes.io/managed-by: prometheus-operator
            app.kubernetes.io/name: alertmanager
            app.kubernetes.io/version: 0.29.0
        spec:
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
                - podAffinityTerm:
                    labelSelector:
                      matchExpressions:
                        - key: app.kubernetes.io/name
                          operator: In
                          values:
                            - alertmanager
                        - key: alertmanager
                          operator: In
                          values:
                            - monitoring-kube-prometheus-alertmanager
                    topologyKey: kubernetes.io/hostname
                  weight: 100
          automountServiceAccountToken: true
          containers:
            - args:
                - --config.file=/etc/alertmanager/config_out/alertmanager.env.yaml
                - --storage.path=/alertmanager
                - --data.retention=120h
                - --cluster.listen-address=
                - --web.listen-address=:9093
                - --web.external-url=http://monitoring-kube-prometheus-alertmanager.monitoring:9093
                - --web.route-prefix=/
                - --cluster.label=monitoring/monitoring-kube-prometheus-alertmanager
                - --cluster.peer=alertmanager-monitoring-kube-prometheus-alertmanager-0.alertmanager-operated:9094
                - --cluster.reconnect-timeout=5m
                - --web.config.file=/etc/alertmanager/web_config/web-config.yaml
              env:
                - name: POD_IP
                  valueFrom:
                    fieldRef:
                      apiVersion: v1
                      fieldPath: status.podIP
              image: quay.io/prometheus/alertmanager:v0.29.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 10
                httpGet:
                  path: /-/healthy
                  port: http-web
                  scheme: HTTP
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 3
              name: alertmanager
              ports:
                - containerPort: 9093
                  name: http-web
                  protocol: TCP
                - containerPort: 9094
                  name: mesh-tcp
                  protocol: TCP
                - containerPort: 9094
                  name: mesh-udp
                  protocol: UDP
              readinessProbe:
                failureThreshold: 10
                httpGet:
                  path: /-/ready
                  port: http-web
                  scheme: HTTP
                initialDelaySeconds: 3
                periodSeconds: 5
                successThreshold: 1
                timeoutSeconds: 3
              resources:
                requests:
                  memory: 200Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              terminationMessagePath: /dev/termination-log
              terminationMessagePolicy: FallbackToLogsOnError
              volumeMounts:
                - mountPath: /etc/alertmanager/config
                  name: config-volume
                - mountPath: /etc/alertmanager/config_out
                  name: config-out
                  readOnly: true
                - mountPath: /etc/alertmanager/certs
                  name: tls-assets
                  readOnly: true
                - mountPath: /alertmanager
                  name: alertmanager-monitoring-kube-prometheus-alertmanager-db
                - mountPath: /etc/alertmanager/web_config/web-config.yaml
                  name: web-config
                  readOnly: true
                  subPath: web-config.yaml
                - mountPath: /etc/alertmanager/cluster_tls_config/cluster-tls-config.yaml
                  name: cluster-tls-config
                  readOnly: true
                  subPath: cluster-tls-config.yaml
            - args:
                - --listen-address=:8080
                - --web-config-file=/etc/alertmanager/web_config/web-config.yaml
                - --reload-url=http://127.0.0.1:9093/-/reload
                - --config-file=/etc/alertmanager/config/alertmanager.yaml.gz
                - --config-envsubst-file=/etc/alertmanager/config_out/alertmanager.env.yaml
                - --watched-dir=/etc/alertmanager/config
              command:
                - /bin/prometheus-config-reloader
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      apiVersion: v1
                      fieldPath: metadata.name
                - name: SHARD
                  value: "-1"
              image: quay.io/prometheus-operator/prometheus-config-reloader:v0.86.2
              imagePullPolicy: IfNotPresent
              name: config-reloader
              ports:
                - containerPort: 8080
                  name: reloader-web
                  protocol: TCP
              resources: {}
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              terminationMessagePath: /dev/termination-log
              terminationMessagePolicy: FallbackToLogsOnError
              volumeMounts:
                - mountPath: /etc/alertmanager/config
                  name: config-volume
                  readOnly: true
                - mountPath: /etc/alertmanager/config_out
                  name: config-out
                - mountPath: /etc/alertmanager/web_config/web-config.yaml
                  name: web-config
                  readOnly: true
                  subPath: web-config.yaml
          dnsPolicy: ClusterFirst
          initContainers:
            - args:
                - --watch-interval=0
                - --listen-address=:8081
                - --config-file=/etc/alertmanager/config/alertmanager.yaml.gz
                - --config-envsubst-file=/etc/alertmanager/config_out/alertmanager.env.yaml
                - --watched-dir=/etc/alertmanager/config
              command:
                - /bin/prometheus-config-reloader
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      apiVersion: v1
                      fieldPath: metadata.name
                - name: SHARD
                  value: "-1"
              image: quay.io/prometheus-operator/prometheus-config-reloader:v0.86.2
              imagePullPolicy: IfNotPresent
              name: init-config-reloader
              ports:
                - containerPort: 8081
                  name: reloader-init
                  protocol: TCP
              resources: {}
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              terminationMessagePath: /dev/termination-log
              terminationMessagePolicy: FallbackToLogsOnError
              volumeMounts:
                - mountPath: /etc/alertmanager/config
                  name: config-volume
                  readOnly: true
                - mountPath: /etc/alertmanager/config_out
                  name: config-out
                - mountPath: /etc/alertmanager/web_config/web-config.yaml
                  name: web-config
                  readOnly: true
                  subPath: web-config.yaml
          restartPolicy: Always
          schedulerName: default-scheduler
          securityContext:
            fsGroup: 2000
            runAsGroup: 2000
            runAsNonRoot: true
            runAsUser: 1000
            seccompProfile:
              type: RuntimeDefault
          serviceAccount: monitoring-kube-prometheus-alertmanager
          serviceAccountName: monitoring-kube-prometheus-alertmanager
          terminationGracePeriodSeconds: 120
          volumes:
            - name: config-volume
              secret:
                defaultMode: 420
                secretName: alertmanager-monitoring-kube-prometheus-alertmanager-generated
            - name: tls-assets
              projected:
                defaultMode: 420
                sources:
                  - secret:
                      name: alertmanager-monitoring-kube-prometheus-alertmanager-tls-assets-0
            - emptyDir:
                medium: Memory
              name: config-out
            - name: web-config
              secret:
                defaultMode: 420
                secretName: alertmanager-monitoring-kube-prometheus-alertmanager-web-config
            - name: cluster-tls-config
              secret:
                defaultMode: 420
                secretName: alertmanager-monitoring-kube-prometheus-alertmanager-cluster-tls-config
            - emptyDir: {}
              name: alertmanager-monitoring-kube-prometheus-alertmanager-db
      updateStrategy:
        type: RollingUpdate
  - apiVersion: apps/v1
    kind: StatefulSet
    metadata:
      annotations:
        meta.helm.sh/release-name: monitoring
        meta.helm.sh/release-namespace: monitoring
        prometheus-operator-input-hash: "7482013664946716801"
      labels:
        app: kube-prometheus-stack-prometheus
        app.kubernetes.io/instance: monitoring-kube-prometheus-prometheus
        app.kubernetes.io/managed-by: prometheus-operator
        app.kubernetes.io/name: prometheus
        app.kubernetes.io/part-of: kube-prometheus-stack
        app.kubernetes.io/version: 79.6.1
        chart: kube-prometheus-stack-79.6.1
        heritage: Helm
        managed-by: prometheus-operator
        operator.prometheus.io/mode: server
        operator.prometheus.io/name: monitoring-kube-prometheus-prometheus
        operator.prometheus.io/shard: "0"
        prometheus: monitoring-kube-prometheus-prometheus
        release: monitoring
      name: prometheus-monitoring-kube-prometheus-prometheus
      namespace: monitoring
      ownerReferences:
        - apiVersion: monitoring.coreos.com/v1
          blockOwnerDeletion: true
          controller: true
          kind: Prometheus
          name: monitoring-kube-prometheus-prometheus
          uid: d52be81e-22a1-483b-861a-2ca76ba85f38
    spec:
      persistentVolumeClaimRetentionPolicy:
        whenDeleted: Retain
        whenScaled: Retain
      podManagementPolicy: Parallel
      replicas: 1
      revisionHistoryLimit: 10
      selector:
        matchLabels:
          app.kubernetes.io/instance: monitoring-kube-prometheus-prometheus
          app.kubernetes.io/managed-by: prometheus-operator
          app.kubernetes.io/name: prometheus
          operator.prometheus.io/name: monitoring-kube-prometheus-prometheus
          operator.prometheus.io/shard: "0"
          prometheus: monitoring-kube-prometheus-prometheus
      serviceName: prometheus-operated
      template:
        metadata:
          annotations:
            kubectl.kubernetes.io/default-container: prometheus
          creationTimestamp: null
          labels:
            app.kubernetes.io/instance: monitoring-kube-prometheus-prometheus
            app.kubernetes.io/managed-by: prometheus-operator
            app.kubernetes.io/name: prometheus
            app.kubernetes.io/version: 3.7.3
            operator.prometheus.io/name: monitoring-kube-prometheus-prometheus
            operator.prometheus.io/shard: "0"
            prometheus: monitoring-kube-prometheus-prometheus
        spec:
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
                - podAffinityTerm:
                    labelSelector:
                      matchExpressions:
                        - key: app.kubernetes.io/name
                          operator: In
                          values:
                            - prometheus
                        - key: app.kubernetes.io/instance
                          operator: In
                          values:
                            - monitoring-kube-prometheus-prometheus
                    topologyKey: kubernetes.io/hostname
                  weight: 100
          automountServiceAccountToken: true
          containers:
            - args:
                - --config.file=/etc/prometheus/config_out/prometheus.env.yaml
                - --web.enable-lifecycle
                - --web.external-url=http://prometheus.kwiki.it.com/
                - --web.route-prefix=/
                - --storage.tsdb.retention.time=10d
                - --storage.tsdb.path=/prometheus
                - --storage.tsdb.wal-compression
                - --web.config.file=/etc/prometheus/web_config/web-config.yaml
              image: quay.io/prometheus/prometheus:v3.7.3
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 6
                httpGet:
                  path: /-/healthy
                  port: http-web
                  scheme: HTTP
                periodSeconds: 5
                successThreshold: 1
                timeoutSeconds: 3
              name: prometheus
              ports:
                - containerPort: 9090
                  name: http-web
                  protocol: TCP
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /-/ready
                  port: http-web
                  scheme: HTTP
                periodSeconds: 5
                successThreshold: 1
                timeoutSeconds: 3
              resources: {}
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              startupProbe:
                failureThreshold: 60
                httpGet:
                  path: /-/ready
                  port: http-web
                  scheme: HTTP
                periodSeconds: 15
                successThreshold: 1
                timeoutSeconds: 3
              terminationMessagePath: /dev/termination-log
              terminationMessagePolicy: FallbackToLogsOnError
              volumeMounts:
                - mountPath: /etc/prometheus/config_out
                  name: config-out
                  readOnly: true
                - mountPath: /etc/prometheus/certs
                  name: tls-assets
                  readOnly: true
                - mountPath: /prometheus
                  name: prometheus-monitoring-kube-prometheus-prometheus-db
                  subPath: prometheus-db
                - mountPath: /etc/prometheus/rules/prometheus-monitoring-kube-prometheus-prometheus-rulefiles-0
                  name: prometheus-monitoring-kube-prometheus-prometheus-rulefiles-0
                - mountPath: /etc/prometheus/web_config/web-config.yaml
                  name: web-config
                  readOnly: true
                  subPath: web-config.yaml
            - args:
                - --listen-address=:8080
                - --reload-url=http://127.0.0.1:9090/-/reload
                - --config-file=/etc/prometheus/config/prometheus.yaml.gz
                - --config-envsubst-file=/etc/prometheus/config_out/prometheus.env.yaml
                - --watched-dir=/etc/prometheus/rules/prometheus-monitoring-kube-prometheus-prometheus-rulefiles-0
              command:
                - /bin/prometheus-config-reloader
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      apiVersion: v1
                      fieldPath: metadata.name
                - name: SHARD
                  value: "0"
              image: quay.io/prometheus-operator/prometheus-config-reloader:v0.86.2
              imagePullPolicy: IfNotPresent
              name: config-reloader
              ports:
                - containerPort: 8080
                  name: reloader-web
                  protocol: TCP
              resources: {}
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              terminationMessagePath: /dev/termination-log
              terminationMessagePolicy: FallbackToLogsOnError
              volumeMounts:
                - mountPath: /etc/prometheus/config
                  name: config
                - mountPath: /etc/prometheus/config_out
                  name: config-out
                - mountPath: /etc/prometheus/rules/prometheus-monitoring-kube-prometheus-prometheus-rulefiles-0
                  name: prometheus-monitoring-kube-prometheus-prometheus-rulefiles-0
          dnsPolicy: ClusterFirst
          initContainers:
            - args:
                - --watch-interval=0
                - --listen-address=:8081
                - --config-file=/etc/prometheus/config/prometheus.yaml.gz
                - --config-envsubst-file=/etc/prometheus/config_out/prometheus.env.yaml
                - --watched-dir=/etc/prometheus/rules/prometheus-monitoring-kube-prometheus-prometheus-rulefiles-0
              command:
                - /bin/prometheus-config-reloader
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      apiVersion: v1
                      fieldPath: metadata.name
                - name: SHARD
                  value: "0"
              image: quay.io/prometheus-operator/prometheus-config-reloader:v0.86.2
              imagePullPolicy: IfNotPresent
              name: init-config-reloader
              ports:
                - containerPort: 8081
                  name: reloader-init
                  protocol: TCP
              resources: {}
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                readOnlyRootFilesystem: true
              terminationMessagePath: /dev/termination-log
              terminationMessagePolicy: FallbackToLogsOnError
              volumeMounts:
                - mountPath: /etc/prometheus/config
                  name: config
                - mountPath: /etc/prometheus/config_out
                  name: config-out
                - mountPath: /etc/prometheus/rules/prometheus-monitoring-kube-prometheus-prometheus-rulefiles-0
                  name: prometheus-monitoring-kube-prometheus-prometheus-rulefiles-0
          restartPolicy: Always
          schedulerName: default-scheduler
          securityContext:
            fsGroup: 2000
            runAsGroup: 2000
            runAsNonRoot: true
            runAsUser: 1000
            seccompProfile:
              type: RuntimeDefault
          serviceAccount: monitoring-kube-prometheus-prometheus
          serviceAccountName: monitoring-kube-prometheus-prometheus
          shareProcessNamespace: false
          terminationGracePeriodSeconds: 600
          volumes:
            - name: config
              secret:
                defaultMode: 420
                secretName: prometheus-monitoring-kube-prometheus-prometheus
            - name: tls-assets
              projected:
                defaultMode: 420
                sources:
                  - secret:
                      name: prometheus-monitoring-kube-prometheus-prometheus-tls-assets-0
            - emptyDir:
                medium: Memory
              name: config-out
            - configMap:
                defaultMode: 420
                name: prometheus-monitoring-kube-prometheus-prometheus-rulefiles-0
              name: prometheus-monitoring-kube-prometheus-prometheus-rulefiles-0
            - name: web-config
              secret:
                defaultMode: 420
                secretName: prometheus-monitoring-kube-prometheus-prometheus-web-config
      updateStrategy:
        type: RollingUpdate
      volumeClaimTemplates:
        - apiVersion: v1
          kind: PersistentVolumeClaim
          metadata:
            creationTimestamp: null
            name: prometheus-monitoring-kube-prometheus-prometheus-db
          spec:
            accessModes:
              - ReadWriteOnce
            resources:
              requests:
                storage: 20Gi
            storageClassName: longhorn
            volumeMode: Filesystem
          status:
            phase: Pending
kind: List
metadata: {}
